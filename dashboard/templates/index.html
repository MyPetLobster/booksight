{% extends "layout.html" %}
{% load static %}

{% block title %}Booksight{% endblock %}
{% block body %}
    <div class="page-identifier" style="display:none">index</div>
    <div class="idx-content">
        <div class="landing-logo-div">
            <img id="logo-eyes" src="{% static 'dashboard/images/eyes-only.png' %}" alt="Booksight Logo Owl Eyes">
            <img id="logo-text" src="{% static 'dashboard/images/booksight-text.png' %}" alt="Booksight Logo Text">
            <p class="hidden-subtitle" style="opacity:0">For the details your eyes can't see</p>
        </div>


        <div class="upload-form-div"  style="opacity:0">
            <form class="floating-form" id="upload-img-form" action="{% url 'vision' %}" method="post" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="form-div">
                    <h3 class="form-title">Upload an image of your bookcase</h2>
                    <p class="form-subtitle">For best results, check out our <a href="{% url 'tips' %}"">tips</a> page</p>
                </div>

                <div class="form-div">
                    <h4>Email Address</h4>
                    <input type="email" id="user-email" name="user-email" placeholder="Enter your email" required>
                </div>

                <div class="form-div">
                    <h4>Export Formats</h4>
                    <div class="checkboxes">
                        <div class="checkbox-option">
                            <label class="checkbox-label" for="csv">CSV&nbsp;</label>
                            <input class="checkbox-box" type="checkbox" id="csv" name="format" value="csv">
                        </div>
                        <div class="checkbox-option">
                            <label class="checkbox-label" for="json">JSON</label>
                            <input class="checkbox-box" type="checkbox" id="json" name="format" value="json">
                        </div>
                        <div class="checkbox-option">
                            <label class="checkbox-label" for="xml">XML&nbsp;</label>
                            <input class="checkbox-box" type="checkbox" id="xml" name="format" value="xml">
                        </div>
                        <div class="checkbox-option">
                            <label class="checkbox-label" for="txt">TXT&nbsp;</label>
                            <input class="checkbox-box" type="checkbox" id="txt" name="format" value="txt">
                        </div>
                        <div class="checkbox-option">
                            <label class="checkbox-label" for="all">ALL&nbsp;</label>
                            <input class="checkbox-box" type="checkbox" id="all" name="all-no-pass" value="all">
                        </div>
                    </div>
                </div>
 
                <div class="form-div upload-div">
                    <input type="file" name="uploaded-image" id="uploaded-image" style="display:none;"/>
                    <label class="button" id="upload-image-button" for="uploaded-image">Upload Image</label>
                </div>

                <div class="btn-box">
                    <input class="button" id="submit-button" type="submit" value="Submit">
                    <button class="button" id="cancel-button" type="button">Cancel</button>
                </div>
                <button class="button" id="adv-options-button" type="button">Advanced Options</button>
                <div id="adv-options-div" style="display:none">
                    <h3 class="form-title" style="align-self:center">Advanced Options</h3>
                </br>
                    <div>
                        <label for="ai-model">AI Model - </label>
                        <select name="ai-model" id="ai-model">
                            <option value="gemini-pro" selected="selected">Gemini Pro (default)</option>
                            <option value="gpt-3.5-turbo">GPT 3.5 Turbo</option>
                            <option value="gpt-4o">GPT 4o</option>
                        </select>
                    </div>
                </br>
                    <div>
                        <label for="ai-temp">AI Temperature - </label>
                        <input type="number" name="ai-temp" id="ai-temp" min="0" max="1" step="0.1" value="0.3">
                    </div>
                </br>
                    <div>
                        <label for="torch-confidence">Torchvision confidence threshold - </label>
                        <input type="number" name="torch-confidence" id="torch-confidence" min="0" max="1" step="0.01" value="0.79">
                    </div>
                </br>
                    <p>Warning: Adjusting these settings may greatly affect the accuracy of the results, use with caution.</p>
                </div>
                <button class="button" id="adv-options-close" type="button" style="display:none">Close Advanced Options</button>
            </form> 



        </div>
    </div>



    <script>
        const selectAll = document.getElementById('all');
        const csv = document.getElementById('csv');
        const json = document.getElementById('json');
        const xml = document.getElementById('xml');
        const txt = document.getElementById('txt');

        selectAll.addEventListener('change', () => {
            if (selectAll.checked) {
                csv.checked = true;
                json.checked = true;
                xml.checked = true;
                txt.checked = true;
            } else {
                csv.checked = false;
                json.checked = false;
                xml.checked = false;
                txt.checked = false;
            }
        })

        csv.addEventListener('change', () => {
            if (csv.checked && json.checked && xml.checked && txt.checked) {
                selectAll.checked = true;
            } else {
                selectAll.checked = false;
            }
        })

        json.addEventListener('change', () => {
            if (csv.checked && json.checked && xml.checked && txt.checked) {
                selectAll.checked = true;
            } else {
                selectAll.checked = false;
            }
        })

        xml.addEventListener('change', () => {
            if (csv.checked && json.checked && xml.checked && txt.checked) {
                selectAll.checked = true;
            } else {
                selectAll.checked = false;
            }
        })

        txt.addEventListener('change', () => {
            if (csv.checked && json.checked && xml.checked && txt.checked) {
                selectAll.checked = true;
            } else {
                selectAll.checked = false;
            }
        })



        const logoEyes = document.getElementById('logo-eyes');
        const logoText = document.getElementById('logo-text');
        const hiddenSubtitle = document.querySelector('.hidden-subtitle');
        const floatingForm = document.querySelector('.upload-form-div');
        const landingLogoDiv = document.querySelector('.landing-logo-div');
        const uploadImageForm = document.getElementById('upload-img-form');
        const cancelBtn = document.querySelector('.btn-box button');
        const advOptionsButton = document.getElementById('adv-options-button');
        const advOptionsDiv = document.getElementById('adv-options-div');
        const advOptionsClose = document.getElementById('adv-options-close');
        const screenWidth = window.innerWidth;
        if (screenWidth > 600) {
            logoEyes.addEventListener('mouseover', () => {
                logoText.style.maxWidth = "110%";
                logoText.style.opacity = 1;
                logoEyes.style.maxWidth = "70%";
                logoEyes.style.opacity = 1;
                hiddenSubtitle.style.opacity = 1;
                hiddenSubtitle.style.transition = "10s";
            })
            logoEyes.addEventListener('mouseout', () => {
                logoText.style.maxWidth = "100%";
                logoText.style.opacity = 0.15;
                logoEyes.style.maxWidth = "60%";
                logoEyes.style.opacity = 0.15;
                hiddenSubtitle.style.opacity = 0;
                hiddenSubtitle.style.transition = "2s";

            })
            logoText.addEventListener('mouseover', () => {
                logoText.style.maxWidth = "110%";
                logoText.style.opacity = 1;
                logoEyes.style.maxWidth = "70%";
                logoEyes.style.opacity = 1;
                hiddenSubtitle.style.opacity = 1;
                hiddenSubtitle.style.transition = "10s";
            })
            logoText.addEventListener('mouseout', () => {
                logoText.style.maxWidth = "100%";
                logoText.style.opacity = 0.15;
                logoEyes.style.maxWidth = "60%";
                logoEyes.style.opacity = 0.15;
                hiddenSubtitle.style.opacity = 0;
                hiddenSubtitle.style.transition = "2s";
            })
            landingLogoDiv.addEventListener('click', () => {
                floatingForm.style.opacity = 1;
                floatingForm.style.zIndex = 999;
                landingLogoDiv.style.opacity = 0;
            })
        } else {
            landingLogoDiv.addEventListener('click', () => {
                // slowly display the subtitle text, darken the logo and text, then display the form and hide the logo/text. 4s total
                logoEyes.style.transition = "2s";
                logoEyes.style.opacity = 1;
                logoText.style.transition = "2s";
                logoText.style.opacity = 1;
                hiddenSubtitle.style.transition = "2s";
                hiddenSubtitle.style.opacity = 1;

                const footer = document.getElementById('footer');
                footer.style.opacity = 0;

                const owlLogoNavItem = document.getElementById('owl-logo-nav-item');
                if (owlLogoNavItem) {
                    owlLogoNavItem.style.transition = "2s";
                    owlLogoNavItem.style.opacity = 0;
                    owlLogoNavItem.style.zIndex = -1;
                }

                setTimeout(() => {
                    logoEyes.style.transition = "2s";
                    logoEyes.style.opacity = 0.15;
                    logoText.style.transition = "2s";
                    logoText.style.opacity = 0.15;
                    hiddenSubtitle.style.transition = "2s";
                    hiddenSubtitle.style.opacity = 0;
                    floatingForm.style.opacity = 1;
                    floatingForm.style.zIndex = 999;
                    landingLogoDiv.style.opacity = 0;
                }, 2000)
            })
        }

            cancelBtn.addEventListener('click', () => {
                floatingForm.style.opacity = 0;
                floatingForm.style.zIndex = -1;
                landingLogoDiv.style.transition = "2s";
                landingLogoDiv.style.opacity = 1;
                logoEyes.style.transition = "2s";
                logoEyes.style.opacity = 0.15;
                logoText.style.transition = "2s";
                logoText.style.opacity = 0.15;
            
                window.scrollTo(0, 0);
                
                const footer = document.getElementById('footer');
                footer.style.opacity = 1;
                const owlLogoNavItem = document.getElementById('owl-logo-nav-item');
                if (owlLogoNavItem) {
                    owlLogoNavItem.style.transition = "2s";
                    owlLogoNavItem.style.opacity = 1;
                    owlLogoNavItem.style.zIndex = 1;
                }
            })
            advOptionsButton.addEventListener('click', () => {
                advOptionsDiv.style.display = 'flex';
                advOptionsClose.style.display = 'block';
                advOptionsButton.style.display = 'none';
            })
            advOptionsClose.addEventListener('click', () => {
                advOptionsDiv.style.display = 'none';
                advOptionsClose.style.display = 'none';
                advOptionsButton.style.display = 'block';
            })     

        
    </script>
{% endblock %}







